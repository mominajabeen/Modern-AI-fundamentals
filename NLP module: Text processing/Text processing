import nltk
from nltk.tokenize import word_tokenize
from nltk.stem import PorterStemmer, WordNetLemmatizer
from nltk.corpus import stopwords
import re
import pandas as pd
data = pd.read_csv("tripadvisor_hotel_reviews.csv")
data.info()
data.head()
data['Review'][0]
data['review_lowercase'] = data['Review'].str.lower()
data['review_no_stopwords'] = data['review_lowercase'] \
.apply(lambda x: ' '.join([word for word in x.split() if word not in en_stopwords]))

data['review_no_stopwords_no_punct'] = data.apply(lambda x: re.sub(r"[*]", "star", x['review_no_stopwords']), axis=1)
data['review_no_stopwords_no_punct'] = data.apply(
lambda x: re.sub(r"([^\w\s])", "", x['review_no_stopwords_no_punct']), axis=1)
ps = PorterStemmer()
data['stemmed'] = data['tokenized'].apply(lambda tokens: [ps.stem(token) for token in tokens])
